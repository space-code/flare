{"metadata":{"title":"Promotional Offers","modules":[{"name":"Flare"}],"roleHeading":"Article","role":"article"},"schemaVersion":{"minor":3,"major":0,"patch":0},"sections":[],"abstract":[{"type":"text","text":"Learn how to use promotional offers."}],"seeAlsoSections":[{"identifiers":["doc:\/\/flare.Flare\/documentation\/Flare\/perform-purchase","doc:\/\/flare.Flare\/documentation\/Flare\/restore-purchase","doc:\/\/flare.Flare\/documentation\/Flare\/refund-purchase","doc:\/\/flare.Flare\/documentation\/Flare\/logging"],"title":"Articles","anchor":"Articles","generated":true}],"hierarchy":{"paths":[["doc:\/\/flare.Flare\/documentation\/Flare"]]},"variants":[{"paths":["\/documentation\/flare\/promotional-offers"],"traits":[{"interfaceLanguage":"swift"}]}],"kind":"article","primaryContentSections":[{"content":[{"anchor":"Overview","level":2,"text":"Overview","type":"heading"},{"inlineContent":[{"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_promotional_offers_in_your_app","isActive":true,"type":"reference"},{"text":" can be effective in winning back lapsed subscribers or retaining current subscribers. You can provide lapsed or current subscribers a limited-time offer of a discounted or free period of service for auto-renewable subscriptions on macOS, iOS, and tvOS.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726"},{"type":"text","text":" can offer a discounted introductory price, including a free trial, to eligible users. You can make introductory offers to customers who haven’t previously received an introductory offer for the given product, or for any products in the same subscription group."}],"type":"paragraph"},{"style":"note","content":[{"inlineContent":[{"text":"To implement the offers, first complete the setup on App Store Connect, including generating a private key. See ","type":"text"},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/setting_up_promotional_offers","type":"reference"},{"text":" for more details.","type":"text"}],"type":"paragraph"}],"name":"Note","type":"aside"},{"anchor":"Introductory-Offers","level":2,"text":"Introductory Offers","type":"heading"},{"style":"important","content":[{"inlineContent":[{"text":"Do not show a subscription offer to users if they are not eligible for it. It’s very important to check this beforehand.","type":"text"}],"type":"paragraph"}],"name":"Important","type":"aside"},{"inlineContent":[{"text":"First, check if the user is eligible for an introductory offer.","type":"text"}],"type":"paragraph"},{"style":"tip","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"For this purpose can be used "},{"isActive":true,"type":"reference","identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/IFlare\/checkEligibility(productIDs:)"},{"type":"text","text":" method. This method requires iOS 15.0, tvOS 15.0, watchOS 8.0, macOS 12.0. Otherwise, see "},{"isActive":true,"type":"reference","overridingTitleInlineContent":[{"text":"Determine Eligibility","type":"text"}],"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726","overridingTitle":"Determine Eligibility"},{"type":"text","text":"."}]}],"name":"Tip","type":"aside"},{"syntax":"swift","code":["func isEligibleForIntroductoryOffer(productID: String) async -> Bool {","    let dict = await Flare.shared.checkEligibility(productIDs: [productID])","    return dict[productID] == .eligible","}"],"type":"codeListing"},{"inlineContent":[{"text":"Second, proceed with the purchase as usual. See ","type":"text"},{"identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/perform-purchase","overridingTitleInlineContent":[{"type":"text","text":"Perform Purchase"}],"type":"reference","isActive":true,"overridingTitle":"Perform Purchase"}],"type":"paragraph"},{"anchor":"Promotional-Offers","level":2,"text":"Promotional Offers","type":"heading"},{"anchor":"Configuration","level":3,"text":"Configuration","type":"heading"},{"inlineContent":[{"text":"Configure ","type":"text"},{"isActive":true,"identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/IFlare","type":"reference"},{"text":" with a ","type":"text"},{"isActive":true,"identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/Configuration","type":"reference"},{"text":".","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["Flare.configure(configuration: Configuration(applicationUsername: \"username\"))"],"type":"codeListing"},{"anchor":"Creating--Requesting-a-Signature","level":3,"text":"Creating & Requesting a Signature","type":"heading"},{"style":"important","content":[{"inlineContent":[{"type":"text","text":"You need to fetch the signature from your server. See "},{"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/generating_a_signature_for_promotional_offers","isActive":true,"type":"reference"},{"type":"text","text":" for more information."}],"type":"paragraph"}],"name":"Important","type":"aside"},{"inlineContent":[{"type":"text","text":"Request a signature from your server and prepare the discount offer."}],"type":"paragraph"},{"syntax":"swift","code":["func prepareOffer(username: String, productID: String, offerID: String, completion: @escaping (PromotionalOffer.SignedData) -> Void) {","    YourServer.fetchOfferDetails(","                username: username,","                productIdentifier: productID,","                offerIdentifier: offerID,","                completion: { (nonce: UUID, timestamp: NSNumber, keyIdentifier: String, signature: String) in","        let signedData = PromotionalOffer.SignedData(","            identifier: offerID,","            keyIdentifier: keyIdentifier,","            nonce: nonce,","            signature: signature,","            timestamp: timestamp","        )","","        completion(signedData)","    }","}"],"type":"codeListing"},{"anchor":"Perform-a-Purchase-with-the-Promotional-Offer","level":3,"text":"Perform a Purchase with the Promotional Offer","type":"heading"},{"inlineContent":[{"text":"Complete the purchase with the promotional offer.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["func purchase(product: StoreProduct, discount: StoreProductDiscount, signedData: SignedData) {","    let promotionalOffer = PromotionalOffer(discount: discount, signedData: signedData)","","    Flare.default.purchase(product: product, promotionalOffer: promotionalOffer) { result in","        switch result {","        case let .success(transaction):","            break","        case let .failure(error):","            break","        }","    }","","    \/\/ Or using async\/await","    let transaction = Flare.shared.purchase(product: product, promotionalOffer: promotionalOffer)","}"],"type":"codeListing"},{"anchor":"Finish-the-Transaction","level":3,"text":"Finish the Transaction","type":"heading"},{"inlineContent":[{"text":"Complete the transaction after purchasing.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["Flare.default.finish(transaction: transaction)"],"type":"codeListing"}],"kind":"content"}],"identifier":{"url":"doc:\/\/flare.Flare\/documentation\/Flare\/promotional-offers","interfaceLanguage":"swift"},"references":{"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/implementing_promotional_offers_in_your_app":{"title":"Promotional offers","titleInlineContent":[{"type":"text","text":"Promotional offers"}],"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_promotional_offers_in_your_app","type":"link","url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_promotional_offers_in_your_app"},"doc://flare.Flare/documentation/Flare":{"abstract":[{"type":"text","text":"Flare provides an elegant interface for In-App Purchases, supporting non-consumable and consumable purchases as well as subscriptions."}],"type":"topic","kind":"symbol","role":"collection","url":"\/documentation\/flare","title":"Flare","identifier":"doc:\/\/flare.Flare\/documentation\/Flare"},"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/setting_up_promotional_offers":{"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/setting_up_promotional_offers","titleInlineContent":[{"type":"text","text":"Setting up promotional offers"}],"url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/setting_up_promotional_offers","title":"Setting up promotional offers"},"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/implementing_introductory_offers_in_your_app#2940726":{"title":"Introductory offers","titleInlineContent":[{"type":"text","text":"Introductory offers"}],"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726","type":"link","url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726"},"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/generating_a_signature_for_promotional_offers":{"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/generating_a_signature_for_promotional_offers","titleInlineContent":[{"type":"text","text":"Generation a signature for promotional offers"}],"url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/generating_a_signature_for_promotional_offers","title":"Generation a signature for promotional offers"},"doc://flare.Flare/documentation/Flare/perform-purchase":{"kind":"article","title":"Perform Purchase","type":"topic","identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/perform-purchase","url":"\/documentation\/flare\/perform-purchase","abstract":[{"text":"Learn how to perform a purchase.","type":"text"}],"role":"article"},"doc://flare.Flare/documentation/Flare/restore-purchase":{"url":"\/documentation\/flare\/restore-purchase","type":"topic","abstract":[{"type":"text","text":"Learn how to restore a purchase."}],"identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/restore-purchase","kind":"article","role":"article","title":"Restore Purchase"},"doc://flare.Flare/documentation/Flare/logging":{"abstract":[{"text":"Learn how to log important events.","type":"text"}],"role":"article","type":"topic","title":"Logging","identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/logging","url":"\/documentation\/flare\/logging","kind":"article"},"doc://flare.Flare/documentation/Flare/IFlare":{"fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"IFlare","kind":"identifier"}],"abstract":[{"code":"Flare","type":"codeVoice"},{"text":" creates and manages in-app purchases.","type":"text"}],"navigatorTitle":[{"text":"IFlare","kind":"identifier"}],"title":"IFlare","kind":"symbol","type":"topic","identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/IFlare","url":"\/documentation\/flare\/iflare","role":"symbol"},"doc://flare.Flare/documentation/Flare/IFlare/checkEligibility(productIDs:)":{"kind":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"checkEligibility","kind":"identifier"},{"text":"(","kind":"text"},{"text":"productIDs","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Set","preciseIdentifier":"s:Sh","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"text":"String","preciseIdentifier":"s:SS","kind":"typeIdentifier"},{"text":">) ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"text":" -> [","kind":"text"},{"text":"String","preciseIdentifier":"s:SS","kind":"typeIdentifier"},{"text":" : ","kind":"text"},{"text":"SubscriptionEligibility","preciseIdentifier":"s:5Flare23SubscriptionEligibilityO","kind":"typeIdentifier"},{"text":"]","kind":"text"}],"identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/IFlare\/checkEligibility(productIDs:)","abstract":[{"type":"text","text":"Checks whether products are eligible for promotional offers"}],"type":"topic","role":"symbol","title":"checkEligibility(productIDs:)","url":"\/documentation\/flare\/iflare\/checkeligibility(productids:)","required":true},"doc://flare.Flare/documentation/Flare/Configuration":{"type":"topic","role":"symbol","url":"\/documentation\/flare\/configuration","abstract":[],"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Configuration","kind":"identifier"}],"title":"Configuration","navigatorTitle":[{"text":"Configuration","kind":"identifier"}],"kind":"symbol","identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/Configuration"},"doc://flare.Flare/documentation/Flare/refund-purchase":{"url":"\/documentation\/flare\/refund-purchase","type":"topic","abstract":[{"type":"text","text":"Learn how to process a refund through an iOS app."}],"identifier":"doc:\/\/flare.Flare\/documentation\/Flare\/refund-purchase","kind":"article","role":"article","title":"Refund Purchase"}}}