{"kind":"article","sections":[],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Flare\/documentation\/Flare\/promotional-offers"},"abstract":[{"text":"Learn how to use promotional offers.","type":"text"}],"metadata":{"modules":[{"name":"Flare"}],"roleHeading":"Article","title":"Promotional Offers","role":"article"},"seeAlsoSections":[{"generated":true,"title":"Articles","identifiers":["doc:\/\/Flare\/documentation\/Flare\/perform-purchase","doc:\/\/Flare\/documentation\/Flare\/restore-purchase","doc:\/\/Flare\/documentation\/Flare\/refund-purchase","doc:\/\/Flare\/documentation\/Flare\/logging"]}],"schemaVersion":{"minor":3,"major":0,"patch":0},"primaryContentSections":[{"kind":"content","content":[{"level":2,"type":"heading","anchor":"Overview","text":"Overview"},{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_promotional_offers_in_your_app"},{"type":"text","text":" can be effective in winning back lapsed subscribers or retaining current subscribers. You can provide lapsed or current subscribers a limited-time offer of a discounted or free period of service for auto-renewable subscriptions on macOS, iOS, and tvOS."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726","isActive":true},{"type":"text","text":" can offer a discounted introductory price, including a free trial, to eligible users. You can make introductory offers to customers who haven’t previously received an introductory offer for the given product, or for any products in the same subscription group."}]},{"name":"Note","content":[{"inlineContent":[{"type":"text","text":"To implement the offers, first complete the setup on App Store Connect, including generating a private key. See "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/setting_up_promotional_offers","isActive":true},{"type":"text","text":" for more details."}],"type":"paragraph"}],"type":"aside","style":"note"},{"anchor":"Introductory-Offers","text":"Introductory Offers","type":"heading","level":2},{"name":"Important","style":"important","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Do not show a subscription offer to users if they are not eligible for it. It’s very important to check this beforehand."}]}],"type":"aside"},{"inlineContent":[{"type":"text","text":"First, check if the user is eligible for an introductory offer."}],"type":"paragraph"},{"style":"tip","type":"aside","name":"Tip","content":[{"inlineContent":[{"type":"text","text":"For this purpose can be used "},{"identifier":"doc:\/\/Flare\/documentation\/Flare\/IFlare\/checkEligibility(productIDs:)","type":"reference","isActive":true},{"type":"text","text":" method. This method requires iOS 15.0, tvOS 15.0, watchOS 8.0, macOS 12.0. Otherwise, see "},{"isActive":true,"overridingTitleInlineContent":[{"text":"Determine Eligibility","type":"text"}],"overridingTitle":"Determine Eligibility","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726","type":"reference"},{"type":"text","text":"."}],"type":"paragraph"}]},{"code":["func isEligibleForIntroductoryOffer(productID: String) async -> Bool {","    let dict = await Flare.shared.checkEligibility(productIDs: [productID])","    return dict[productID] == .eligible","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"Second, proceed with the purchase as usual. See "},{"isActive":true,"identifier":"doc:\/\/Flare\/documentation\/Flare\/perform-purchase","type":"reference","overridingTitleInlineContent":[{"type":"text","text":"Perform Purchase"}],"overridingTitle":"Perform Purchase"}],"type":"paragraph"},{"text":"Promotional Offers","level":2,"type":"heading","anchor":"Promotional-Offers"},{"type":"heading","anchor":"Configuration","text":"Configuration","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Configure "},{"identifier":"doc:\/\/Flare\/documentation\/Flare\/IFlare","type":"reference","isActive":true},{"text":" with a ","type":"text"},{"type":"codeVoice","code":"Configuration"},{"type":"text","text":"."}]},{"code":["Flare.configure(configuration: Configuration(applicationUsername: \"username\"))"],"syntax":"swift","type":"codeListing"},{"text":"Creating & Requesting a Signature","type":"heading","level":3,"anchor":"Creating--Requesting-a-Signature"},{"content":[{"inlineContent":[{"text":"You need to fetch the signature from your server. See ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/generating_a_signature_for_promotional_offers"},{"text":" for more information.","type":"text"}],"type":"paragraph"}],"style":"important","type":"aside","name":"Important"},{"inlineContent":[{"text":"Request a signature from your server and prepare the discount offer.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["func prepareOffer(username: String, productID: String, offerID: String, completion: @escaping (PromotionalOffer.SignedData) -> Void) {","    YourServer.fetchOfferDetails(","                username: username,","                productIdentifier: productID,","                offerIdentifier: offerID,","                completion: { (nonce: UUID, timestamp: NSNumber, keyIdentifier: String, signature: String) in","        let signedData = PromotionalOffer.SignedData(","            identifier: offerID,","            keyIdentifier: keyIdentifier,","            nonce: nonce,","            signature: signature,","            timestamp: timestamp","        )","","        completion(signedData)","    }","}"],"type":"codeListing"},{"type":"heading","level":3,"text":"Perform a Purchase with the Promotional Offer","anchor":"Perform-a-Purchase-with-the-Promotional-Offer"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Complete the purchase with the promotional offer."}]},{"syntax":"swift","code":["func purchase(product: StoreProduct, discount: StoreProductDiscount, signedData: SignedData) {","    let promotionalOffer = PromotionalOffer(discount: discount, signedData: signedData)","","    Flare.default.purchase(product: product, promotionalOffer: promotionalOffer) { result in","        switch result {","        case let .success(transaction):","            break","        case let .failure(error):","            break","        }","    }","","    \/\/ Or using async\/await","    let transaction = Flare.shared.purchase(product: product, promotionalOffer: promotionalOffer)","}"],"type":"codeListing"},{"type":"heading","level":3,"text":"Finish the Transaction","anchor":"Finish-the-Transaction"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Complete the transaction after purchasing."}]},{"syntax":"swift","type":"codeListing","code":["Flare.default.finish(transaction: transaction)"]}]}],"hierarchy":{"paths":[["doc:\/\/Flare\/documentation\/Flare"]]},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/flare\/promotional-offers"]}],"references":{"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/generating_a_signature_for_promotional_offers":{"titleInlineContent":[{"text":"Generation a signature for promotional offers","type":"text"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/generating_a_signature_for_promotional_offers","url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/generating_a_signature_for_promotional_offers","title":"Generation a signature for promotional offers"},"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/implementing_introductory_offers_in_your_app#2940726":{"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726","titleInlineContent":[{"text":"Introductory offers","type":"text"}],"url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_introductory_offers_in_your_app#2940726","type":"link","title":"Introductory offers"},"doc://Flare/documentation/Flare/logging":{"identifier":"doc:\/\/Flare\/documentation\/Flare\/logging","type":"topic","title":"Logging","kind":"article","abstract":[{"type":"text","text":"Learn how to log important events."}],"url":"\/documentation\/flare\/logging","role":"article"},"doc://Flare/documentation/Flare":{"url":"\/documentation\/flare","identifier":"doc:\/\/Flare\/documentation\/Flare","kind":"symbol","type":"topic","abstract":[{"type":"text","text":"Flare provides an elegant interface for In-App Purchases, supporting non-consumable and consumable purchases as well as subscriptions."}],"title":"Flare","role":"collection"},"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/setting_up_promotional_offers":{"titleInlineContent":[{"text":"Setting up promotional offers","type":"text"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/setting_up_promotional_offers","url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/setting_up_promotional_offers","title":"Setting up promotional offers"},"doc://Flare/documentation/Flare/IFlare":{"role":"symbol","identifier":"doc:\/\/Flare\/documentation\/Flare\/IFlare","url":"\/documentation\/flare\/iflare","abstract":[{"code":"Flare","type":"codeVoice"},{"type":"text","text":" creates and manages in-app purchases."}],"title":"IFlare","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"IFlare"}],"kind":"symbol","navigatorTitle":[{"text":"IFlare","kind":"identifier"}],"type":"topic"},"doc://Flare/documentation/Flare/perform-purchase":{"identifier":"doc:\/\/Flare\/documentation\/Flare\/perform-purchase","type":"topic","title":"Perform Purchase","kind":"article","abstract":[{"type":"text","text":"Learn how to perform a purchase."}],"url":"\/documentation\/flare\/perform-purchase","role":"article"},"doc://Flare/documentation/Flare/IFlare/checkEligibility(productIDs:)":{"role":"symbol","url":"\/documentation\/flare\/iflare\/checkeligibility(productids:)","title":"checkEligibility(productIDs:)","kind":"symbol","identifier":"doc:\/\/Flare\/documentation\/Flare\/IFlare\/checkEligibility(productIDs:)","required":true,"type":"topic","abstract":[{"type":"text","text":"Checks whether products are eligible for promotional offers"}],"fragments":[{"text":"func","kind":"keyword"},{"kind":"text","text":" "},{"text":"checkEligibility","kind":"identifier"},{"kind":"text","text":"("},{"kind":"externalParam","text":"productIDs"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Set","preciseIdentifier":"s:Sh"},{"text":"<","kind":"text"},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"},{"kind":"text","text":">) "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"text":"throws","kind":"keyword"},{"kind":"text","text":" -> ["},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"},{"text":" : ","kind":"text"},{"preciseIdentifier":"s:5Flare23SubscriptionEligibilityO","text":"SubscriptionEligibility","kind":"typeIdentifier"},{"kind":"text","text":"]"}]},"doc://Flare/documentation/Flare/restore-purchase":{"identifier":"doc:\/\/Flare\/documentation\/Flare\/restore-purchase","type":"topic","title":"Restore Purchase","kind":"article","abstract":[{"type":"text","text":"Learn how to restore a purchase."}],"url":"\/documentation\/flare\/restore-purchase","role":"article"},"https://developer.apple.com/documentation/storekit/in-app_purchase/original_api_for_in-app_purchase/subscriptions_and_offers/implementing_promotional_offers_in_your_app":{"identifier":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_promotional_offers_in_your_app","titleInlineContent":[{"text":"Promotional offers","type":"text"}],"url":"https:\/\/developer.apple.com\/documentation\/storekit\/in-app_purchase\/original_api_for_in-app_purchase\/subscriptions_and_offers\/implementing_promotional_offers_in_your_app","type":"link","title":"Promotional offers"},"doc://Flare/documentation/Flare/refund-purchase":{"identifier":"doc:\/\/Flare\/documentation\/Flare\/refund-purchase","type":"topic","title":"Refund Purchase","kind":"article","abstract":[{"type":"text","text":"Learn how to process a refund through an iOS app."}],"url":"\/documentation\/flare\/refund-purchase","role":"article"}}}